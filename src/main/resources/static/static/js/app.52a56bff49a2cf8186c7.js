webpackJsonp([1],{NHnr:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=a("7+uW"),o={render:function(){var e=this.$createElement,t=this._self._c||e;return t("div",{attrs:{id:"app"}},[t("router-view")],1)},staticRenderFns:[]};var n=a("VU/8")({name:"App"},o,!1,function(e){a("gLcT")},null,null).exports,s=a("/ocq"),i={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("el-form",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],staticClass:"login-container",attrs:{rules:e.rules,model:e.loginForm,"label-position":"left","label-width":"0px"}},[a("h3",{staticClass:"login_title"},[e._v("系统登录")]),e._v(" "),a("el-form-item",{attrs:{prop:"loginname"}},[a("el-input",{attrs:{type:"text","auto-complete":"off",placeholder:"账号"},model:{value:e.loginForm.loginname,callback:function(t){e.$set(e.loginForm,"loginname",t)},expression:"loginForm.loginname"}})],1),e._v(" "),a("el-form-item",{attrs:{prop:"password"}},[a("el-input",{attrs:{type:"password","auto-complete":"off",placeholder:"密码"},model:{value:e.loginForm.password,callback:function(t){e.$set(e.loginForm,"password",t)},expression:"loginForm.password"}})],1),e._v(" "),a("el-form-item",{staticStyle:{width:"100%"}},[a("el-button",{staticStyle:{width:"100%"},attrs:{type:"primary"},nativeOn:{click:function(t){return t.preventDefault(),e.submitClick(t)}}},[e._v("登录")])],1)],1)},staticRenderFns:[]};var l=a("VU/8")({name:"Login",data:function(){return{rules:{loginname:[{required:!0,message:"请输入用户名",trigger:"blur"}],password:[{required:!0,message:"请输入密码",trigger:"blur"}]},loginForm:{loginname:"",password:""},loading:!1}},methods:{submitClick:function(){var e=this,t=this;this.loading=!0,this.postRequest("/login",{loginname:this.loginForm.loginname,password:this.loginForm.password}).then(function(a){if(t.loading=!1,a&&200===a.status){var r=a.data;t.$store.commit("login",r.msg),t.$router.replace({path:"/"})}else e.$message({message:a.data.status,center:!0})})}}},i,!1,function(e){a("hzMh")},null,null).exports,u={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("el-container",{staticClass:"home-container"},[a("el-aside",{style:{width:e.isCollapse?"0px":"200px",height:"100%"}},[a("el-menu",{staticClass:"el-menu-vertical",staticStyle:{height:"100%"},attrs:{"default-active":"/memberlist",router:"","unique-opened":"","background-color":"#545c64","text-color":"#fff","active-text-color":"#ffd04b"}},[a("el-menu-item",{attrs:{index:"/memberlist"},on:{click:e.handleCollapse}},[e._v("查看/编辑组员信息")]),e._v(" "),a("el-menu-item",{attrs:{index:"/updatepwd"},on:{click:e.handleCollapse}},[e._v("更改密码")]),e._v(" "),a("el-menu-item",{attrs:{index:"/"},on:{click:e.handleCollapse}},[e._v("报表(待..)")]),e._v(" "),a("el-menu-item",{attrs:{index:"/"},on:{click:e.logOut}},[e._v("退出")])],1)],1),e._v(" "),a("el-container",[a("el-header",{staticClass:"home-header"},[a("div",{staticClass:"menu-icon",on:{click:e.handleCollapse}},[a("i",{staticClass:"el-icon-menu"})]),e._v("A'men")]),e._v(" "),a("div",{staticStyle:{height:"100%"},on:{click:e.checkCollapse}},[a("router-view")],1),e._v(" "),a("el-footer",[e._v("Copyright ©2018 v1.0.0")])],1)],1)},staticRenderFns:[]};var m=a("VU/8")({name:"Home",data:function(){return{isCollapse:!0}},methods:{logOut:function(){var e=this;this.$confirm("注销登录, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){e.$store.commit("logout"),e.$router.replace({name:"Login"})})},handleCollapse:function(){this.isCollapse=!this.isCollapse},checkCollapse:function(){this.isCollapse||(this.isCollapse=!0)}},mounted:function(){this.initMemberList(this.$store)}},u,!1,function(e){a("eduQ")},null,null).exports,c={name:"UpdatePwd",data:function(){var e=this;return{rules:{oPassword:[{required:!0,min:6,message:"请输入正确密码",trigger:"blur"}],nPassword:[{validator:function(t,a,r){""===a||"123456"===a||a.length<6?r(new Error("请输入密码,且不可过于简单!")):(""!==e.pForm.cPassword&&e.$refs.pForm.validateField("cPassword"),r())},trigger:"blur"}],cPassword:[{validator:function(t,a,r){""===a?r(new Error("请再次输入密码")):a!==e.pForm.nPassword?r(new Error("两次输入密码不一致!")):r()},trigger:["blur","change"]}]},pForm:{oPassword:"",nPassword:"",cPassword:""},loading:!1}},methods:{restForm:function(){this.$refs.pForm.resetFields()},submitClick:function(){var e=this,t=this;this.loading=!0,this.$refs.pForm.validate(function(a){if(!a)return t.$message({message:"请输入正确内容",center:!0}),e.loading=!1,!1;t.postRequest("/user/updatepassword",{userId:t.$store.state.user.userid,oPassword:t.pForm.oPassword,nPassword:t.pForm.nPassword}).then(function(e){t.loading=!1,e&&200===e.status?(t.$message({message:e.data.msg,center:!0}),t.$router.replace({path:"/"})):t.$router.replace({name:"Login"})}),e.loading=!1})}}},d={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("el-container",[a("el-main",[a("el-form",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],ref:"pForm",attrs:{rules:e.rules,"status-icon":"",model:e.pForm,"label-position":"left","label-width":"0px"}},[a("el-form-item",{attrs:{prop:"oPassword"}},[a("el-input",{attrs:{type:"password","auto-complete":"off",placeholder:"原密码"},model:{value:e.pForm.oPassword,callback:function(t){e.$set(e.pForm,"oPassword",t)},expression:"pForm.oPassword"}})],1),e._v(" "),a("el-form-item",{attrs:{prop:"nPassword"}},[a("el-input",{attrs:{type:"password","auto-complete":"off",placeholder:"新密码"},model:{value:e.pForm.nPassword,callback:function(t){e.$set(e.pForm,"nPassword",t)},expression:"pForm.nPassword"}})],1),e._v(" "),a("el-form-item",{attrs:{prop:"cPassword"}},[a("el-input",{attrs:{type:"password","auto-complete":"off",placeholder:"再次输入新密码"},model:{value:e.pForm.cPassword,callback:function(t){e.$set(e.pForm,"cPassword",t)},expression:"pForm.cPassword"}})],1),e._v(" "),a("el-form-item",{staticStyle:{width:"100%"}},[a("el-button",{staticStyle:{width:"100%"},attrs:{type:"primary"},nativeOn:{click:function(t){return t.preventDefault(),e.submitClick(t)}}},[e._v("修改")]),e._v(" "),a("el-button",{staticStyle:{width:"100%",margin:"0px"},attrs:{type:"warning"},on:{click:e.restForm}},[e._v("重置")])],1)],1)],1)],1)},staticRenderFns:[]};var p=a("VU/8")(c,d,!1,function(e){a("UIjW")},null,null).exports,f={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("el-container",[a("el-main",{staticStyle:{padding:"10px"}},[e.openArea?a("el-select",{staticStyle:{margin:"5px",float:"left"},attrs:{placeholder:"请选择区"},on:{change:e.changeArea},model:{value:e.cArea,callback:function(t){e.cArea=t},expression:"cArea"}},e._l(e.areaOpt,function(e){return a("el-option",{key:e.id,attrs:{label:e.organizationname,value:e.id}})})):e._e(),e._v(" "),e.openTeam?a("el-select",{staticStyle:{margin:"5px",float:"left"},attrs:{placeholder:"请选择小组"},on:{change:e.changeTeam},model:{value:e.cTeam,callback:function(t){e.cTeam=t},expression:"cTeam"}},e._l(e.teamOpt,function(e){return a("el-option",{key:e.id,attrs:{label:e.organizationname,value:e.id}})})):e._e(),e._v(" "),a("el-button",{staticStyle:{"margin-bottom":"5px",float:"right"},attrs:{type:"primary"},nativeOn:{click:function(t){return t.preventDefault(),e.newForm(t)}}},[e._v("新增")]),e._v(" "),a("el-table",{staticStyle:{width:"100%"},attrs:{data:e.tableData,border:""}},[a("el-table-column",{attrs:{prop:"username",label:"用户名",width:"120"}}),e._v(" "),a("el-table-column",{attrs:{prop:"nickname",label:"昵称",width:"120"}}),e._v(" "),a("el-table-column",{attrs:{fixed:"right",label:"操作"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-button",{attrs:{type:"info",size:"small"},on:{click:function(a){e.handleClick(t.row,!1)}}},[e._v("查看")]),e._v(" "),a("el-button",{attrs:{type:"danger",size:"small"},on:{click:function(a){e.handleClick(t.row,!0)}}},[e._v("编辑")])]}}])})],1)],1)],1)},staticRenderFns:[]},g=a("VU/8")({name:"MemberList",methods:{handleClick:function(e,t){this.$router.push({name:"MemberInfo",params:{loginname:e.loginname,phone:e.phone,username:e.username,isEdit:t,date:e.joinchurchdate,userid:e.userid,isNew:!1}})},newForm:function(){this.$router.push({name:"MemberInfo",params:{isNew:!0}})},changeArea:function(){var e=this;this.postRequest("/org/getChildTeams",{aId:this.cArea}).then(function(t){t&&200===t.status&&"success"===t.data.status&&(e.$store.commit("initTeams",t.data.data),e.cTeam=e.teamOpt[0].id,e.changeTeam())})},changeTeam:function(){var e=this;this.postRequest("/user/getMembers",{gId:this.cTeam}).then(function(t){t&&200===t.status&&"success"===t.data.status&&e.$store.commit("initMemberList",t.data.data)})}},computed:{tableData:function(){return this.$store.state.members},areaOpt:function(){return this.$store.state.areas},teamOpt:function(){return this.$store.state.teams},cTeam:{get:function(){return this.$store.state.cTeam},set:function(e){this.$store.commit("setCTeam",e)}},cArea:{get:function(){return this.$store.state.cArea},set:function(e){this.$store.commit("setCArea",e)}},openArea:function(){return"区牧"===this.$store.state.rolename},openTeam:function(){return"区牧"===this.$store.state.rolename||"区长"===this.$store.state.rolename}}},f,!1,null,null,null).exports,h={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("el-container",[a("el-main",{staticStyle:{padding:"10px"}},[a("el-form",{ref:"ruleForm",staticClass:"demo-ruleForm",attrs:{model:e.ruleForm,rules:e.rules,"label-width":"100px"}},[a("el-form-item",{attrs:{label:"用户名",prop:"loginname"}},[e.isEdit?a("el-input",{model:{value:e.ruleForm.loginname,callback:function(t){e.$set(e.ruleForm,"loginname",t)},expression:"ruleForm.loginname"}}):a("div",{staticStyle:{"text-align":"left"}},[a("span",[e._v(":   "+e._s(e.ruleForm.loginname))])])],1),e._v(" "),a("el-form-item",{attrs:{label:"手机号",prop:"phone"}},[e.isEdit?a("el-input",{model:{value:e.ruleForm.phone,callback:function(t){e.$set(e.ruleForm,"phone",t)},expression:"ruleForm.phone"}}):a("div",{staticStyle:{"text-align":"left"}},[a("span",[e._v(":   "+e._s(e.ruleForm.phone))])])],1),e._v(" "),a("el-form-item",{attrs:{label:"姓名",prop:"username"}},[e.isEdit?a("el-input",{model:{value:e.ruleForm.username,callback:function(t){e.$set(e.ruleForm,"username",t)},expression:"ruleForm.username"}}):a("div",{staticStyle:{"text-align":"left"}},[a("span",[e._v(":   "+e._s(e.ruleForm.username))])])],1),e._v(" "),a("el-form-item",{attrs:{label:"加入时间",required:""}},[a("el-col",{attrs:{span:11}},[a("el-form-item",{attrs:{prop:"date"}},[e.isEdit?a("el-date-picker",{staticStyle:{width:"100%"},attrs:{type:"date",placeholder:"选择日期"},model:{value:e.ruleForm.date,callback:function(t){e.$set(e.ruleForm,"date",t)},expression:"ruleForm.date"}}):a("div",{staticStyle:{"text-align":"left"}},[a("span",[e._v(":   "+e._s(e._f("formatDate")(e.ruleForm.date)))])])],1)],1)],1),e._v(" "),a("el-form-item",[e.isEdit?a("el-button",{attrs:{type:"primary"},nativeOn:{click:function(t){return t.preventDefault(),e.submitChange(t)}}},[e._v("提交")]):e._e(),e._v(" "),a("el-button",{nativeOn:{click:function(t){return t.preventDefault(),e.goBack(t)}}},[e._v("返回")])],1)],1)],1)],1)},staticRenderFns:[]};var v=a("VU/8")({name:"MemberInfo",data:function(){return{userid:"",isEdit:!1,isNew:!1,ruleForm:{loginname:"",phone:"",username:"",date:""},rules:{loginname:[{required:!0,message:"请输入用户名",trigger:"blur"}],phone:[{required:!0,message:"请输入手机号",trigger:"blur"}],username:[{required:!0,message:"请输入姓名",trigger:"blur"}],date:[{type:"date",required:!0,message:"请选择加入日期",trigger:"blur"}]}}},computed:{cTeam:function(){return this.$store.state.cTeam}},methods:{goBack:function(){this.$router.back()},submitChange:function(){var e=this,t=this;this.postRequest("/user/updateMember",{userId:this.userid,mobile:this.ruleForm.phone,username:this.ruleForm.username,loginname:this.ruleForm.loginname}).then(function(a){a&&200===a.status&&"success"===a.data.status&&(t.$message({message:a.data.msg,center:!0}),t.postRequest("/user/getMembers",{gId:e.cTeam}).then(function(t){t&&200===t.status&&"success"===t.data.status&&e.$store.commit("initMemberList",t.data.data)}),t.$router.push({name:"Home"}))})}},mounted:function(){this.$route.params.isNew?(this.isNew=!0,this.isEdit=!0):(this.ruleForm.loginname=this.$route.params.loginname,this.ruleForm.phone=this.$route.params.phone,this.ruleForm.username=this.$route.params.username,this.ruleForm.date=this.formatDate(this.$route.params.date),this.userid=this.$route.params.userid,this.isEdit=this.$route.params.isEdit)}},h,!1,function(e){a("da9d")},"data-v-078b17d6",null).exports;r.default.use(s.a);var w=new s.a({routes:[{path:"/",name:"Home",component:m,redirect:"/memberlist",children:[{path:"/updatepwd",name:"UpdatePwd",component:p},{path:"/memberlist",name:"MemberList",component:g},{path:"/memberinfo",name:"MemberInfo",component:v}]},{path:"/login",name:"Login",component:l}]}),b=a("mvHQ"),F=a.n(b),_=a("NYxO");r.default.use(_.a);var $=new _.a.Store({state:{user:null==window.localStorage.getItem("user")?void 0:JSON.parse(window.localStorage.getItem("user")),members:void 0,cTeam:"",cArea:"",rolename:null==window.localStorage.getItem("rolename")?void 0:JSON.parse(window.localStorage.getItem("rolename")),areas:null==window.localStorage.getItem("areas")?void 0:JSON.parse(window.localStorage.getItem("areas")),teams:null==window.localStorage.getItem("teams")?void 0:JSON.parse(window.localStorage.getItem("teams"))},mutations:{login:function(e,t){e.user=t,window.localStorage.setItem("user",F()(t))},logout:function(e){window.localStorage.removeItem("user"),window.localStorage.removeItem("rolename"),window.localStorage.removeItem("areas"),window.localStorage.removeItem("teams"),e.user=void 0,e.members=void 0,e.areas=void 0,e.teams=void 0,e.cTeam="",e.cArea=""},initMemberList:function(e,t){e.members=t},initAreas:function(e,t){e.areas=t,window.localStorage.setItem("areas",F()(t))},initTeams:function(e,t){e.teams=t,window.localStorage.setItem("teams",F()(t))},initRolename:function(e,t){e.rolename=t,window.localStorage.setItem("rolename",F()(t))},setCTeam:function(e,t){e.cTeam=t},setCArea:function(e,t){e.cArea=t}},actions:{login:function(e,t){e.commit("login",t)},logout:function(e){e.commit("logout")}}}),y=a("zL8q"),x=a.n(y),k=(a("tvR6"),a("//Fk")),C=a.n(k),S=a("mtWM"),T=a.n(S);T.a.interceptors.request.use(function(e){return e},function(e){return y.Message.error({message:"请求超时!"}),C.a.resolve(e)}),T.a.interceptors.response.use(function(e){if(!e.status||200!==e.status||"error"!==e.data.status)return e;y.Message.error({message:e.data.msg})},function(e){return 504===e.response.status||404===e.response.status?y.Message.error({message:"服务器被吃了⊙﹏⊙∥"}):403===e.response.status?y.Message.error({message:"权限不足,请联系管理员!"}):y.Message.error({message:"未知错误!"}),C.a.resolve(e)});var I=function(e){return T()({method:"get",url:""+e})};function M(e){if(void 0!==e){var t=P(e),a=t.getFullYear(),r=t.getMonth()+1,o=t.getDate();return r<10&&(r="0"+r),o<10&&(o="0"+o),a+"-"+r+"-"+o}}function P(e){return(e=e.replace(/T/g," ").replace(/\.[\d]{3}Z/,"").replace(/(-)/g,"/")).indexOf(".")>0&&(e=e.slice(0,e.indexOf("."))),new Date(e)}r.default.filter("formatDate",M),r.default.prototype.formatDate=M,r.default.filter("formatDateTime",function(e){if(void 0!==e){var t=P(e),a=t.getFullYear(),r=t.getMonth()+1,o=t.getDate(),n=t.getHours(),s=t.getMinutes();return r<10&&(r="0"+r),o<10&&(o="0"+o),a+"-"+r+"-"+o+" "+n+":"+s}});function R(e){e.state.areas!==[]&&void 0!==e.state.areas||(console.log("doInit Areas"),I("/org/getChildAreas").then(function(t){t&&200===t.status&&"success"===t.data.status&&e.commit("initAreas",t.data.data)}))}function q(e){e.state.teams!==[]&&void 0!==e.state.teams||(console.log("doInit Teams"),I("/org/getChildTeams").then(function(t){t&&200===t.status&&"success"===t.data.status&&e.commit("initTeams",t.data.data)}))}r.default.config.productionTip=!1,r.default.use(x.a),r.default.use(_.b),r.default.prototype.getRequest=I,r.default.prototype.postRequest=function(e,t){return T()({method:"post",url:""+e,data:t,transformRequest:[function(e){var t="";for(var a in e)t+=encodeURIComponent(a)+"="+encodeURIComponent(e[a])+"&";return t}],headers:{"Content-Type":"application/x-www-form-urlencoded"}})},r.default.prototype.deleteRequest=function(e){return T()({method:"delete",url:""+e})},r.default.prototype.putRequest=function(e,t){return T()({method:"put",url:""+e,data:t,transformRequest:[function(e){var t="";for(var a in e)t+=encodeURIComponent(a)+"="+encodeURIComponent(e[a])+"&";return t}],headers:{"Content-Type":"application/x-www-form-urlencoded"}})},r.default.prototype.initMemberList=function(e){var t=!1,a=e.state.user.authorities;if(void 0!==e.state.user&&a!==[]&&void 0!==a)for(var r in a)if("区牧"===a[r].authority)return e.commit("initRolename","区牧"),R(e),q(e),void(t=!0);if(void 0!==e.state.user&&!t&&a!==[]&&void 0!==a)for(var o in a)if("区长"===a[o].authority)return e.commit("initRolename","区长"),void q(e);e.state.members!==[]&&void 0!==e.state.members&&null!==e.state.members||I("/user/getMembers").then(function(t){t&&200===t.status&&"success"===t.data.status&&(e.commit("initMemberList",t.data.data),e.commit("setCTeam",e.state.user.groupid))})},w.beforeEach(function(e,t,a){var r=$.state.user;"Login"===e.name?r&&w.push({name:"Home"}):void 0===r&&w.push({name:"Login"}),a()}),new r.default({el:"#app",router:w,store:$,components:{App:n},template:"<App/>"})},UIjW:function(e,t){},da9d:function(e,t){},eduQ:function(e,t){},gLcT:function(e,t){},hzMh:function(e,t){},tvR6:function(e,t){}},["NHnr"]);
//# sourceMappingURL=app.52a56bff49a2cf8186c7.js.map